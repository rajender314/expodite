<div class="order-main-container">
  <mat-toolbar>
    <div class="create-order-title-wrapper">
      <h2 class="order-main-title">{{ data.title }}</h2>
    </div>
  </mat-toolbar>
  <mat-dialog-content>
    <form>
      <app-package-form-builder
        [module]="data.tableName"
        (trigger)="formEmitEvent($event)"
        [Contacts]="data.prefillId ? data.prefillId : ''"
        [editTypeForRestrict]="true"
        [dropDownRelatedId]="data.related_to_id ? data.related_to_id : ''"
        (setResetProductsForm)="setResetProductsForm()"
      ></app-package-form-builder>
      <app-package-products-form
        [is_pallet]="is_pallet"
        [module]="'add_product_in_package'"
        [importLineItems]="false"
        [selectClientRequired]="true"
        [related_to_id]="data.related_to_id"
        (trigger)="formEmitEvent($event)"
        [Contacts]="data.prefillId ? data.prefillId : ''"
        [packageQuantity]="packageQuantity"
        [productRemainQty]="productRemainQty"
        [resetProductsForm]="resetProductsForm"
        [customPackingLabel]="PackingLabel"
      >
        <!-- (getProductsData)="getProductsData($event)" -->
        <!-- (handleRemainingQtytError)="handleRemainingQtytError($event)" -->
      </app-package-products-form>

      <div style="margin-top: 15px">
        <app-package-form-builder
          [module]="'package_totals'"
          [metaData]="metaData"
          [is_pallet]="is_pallet"
          (trigger)="formEmitEvent($event)"
          [Contacts]="data.prefillId ? data.prefillId : ''"
          [editTypeForRestrict]="true"
          [dropDownRelatedId]="data.related_to_id ? data.related_to_id : ''"
          [customPackingLabel]="PackingLabel"
        ></app-package-form-builder>
      </div>
    </form>
    <div style="margin: 10px; margin-bottom: 16px">
      <b> Package Label :</b> {{ generatePackingLabels() }}
    </div>
    <!-- {{ productsRemainAndTotalQty() }} -->
    <div style="margin: 10px" [innerHTML]="productsRemainAndTotalQty()"></div>
  </mat-dialog-content>

  <mat-dialog-actions>
    <span fxFlex></span>
    <button class="back-btn-ui" *ngIf="!disabledSave" mat-dialog-close>
      Cancel
    </button>
    <button
      *ngIf="
        packageForm?.dirty || productsForm?.dirty || packageTotalsForm?.dirty
      "
      mat-raised-button
      (click)="editProducts()"
      [disabled]="
        !packageForm?.valid ||
        !productsForm?.valid ||
        !packageTotalsForm?.valid ||
        productsForm?.value?.productItem.length == 0 ||
        disabledSave ||
        handleRemainingQtytError()
      "
    >
      Save
      <span *ngIf="disabledSave">
        <mat-icon style="height: 16px; width: 16px"
          ><mat-spinner
            class="white-spinner"
            diameter="20"
          ></mat-spinner></mat-icon
      ></span>
    </button>
  </mat-dialog-actions>
</div>
