<mat-toolbar>
  <div>
    <h2 mat-dialog-title>
      {{ data.rowData ? "Apply Payment" : "Apply Payment" }}
    </h2>
    <p class="invoice-nbr">
      To Invoice No :
      <span style="font-weight: 600">{{
        data.invoiceData?.commercial_invoice[0]?.invoice_no
      }}</span>
    </p>
  </div>
  <span fxFlex></span>
</mat-toolbar>
<!-- <mat-dialog-content class="content"> -->
<!-- <span>Payment Summary</span>

  <div *ngIf="row_data.length > 0" class="table-container">
    <table mat-table [dataSource]="row_data" class="mat-elevation-z8">
      <ng-container
        *ngFor="let column of column_data"
        [matColumnDef]="column.field"
      >
        <th mat-header-cell *matHeaderCellDef>{{ column.headerName }}</th>
        <td mat-cell *matCellDef="let element">
          <ng-container
            *ngIf="column.field === 'date_of_payment'; else defaultCell"
          >
            {{ element[column.field] | date : "medium" }}
          </ng-container>
          <ng-template #defaultCell>
            {{ element[column.field] }}
          </ng-template>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div> -->
<!-- <app-ag-grid-view
    [paymentsId]="data.invoice_id"
    (emitGridEvent)="triggerGridEvent($event)"
    [tableName]="'payments'"
  ></app-ag-grid-view> -->
<!-- 
  <div *ngIf="!(row_data.length > 0)" class="no-payment">
    <ng-container>
      <span> No Payment Activity Found. </span>
    </ng-container>
  </div> -->
<!-- </mat-dialog-content> -->
<mat-dialog-content class="content">
  <!-- *ngIf="!data.invoiceData?.commercial_invoice[0]?.is_totally_paid" -->
  <span class="font-600 custom-label"
    >Balance Amount ({{ data.currency }}) : </span
  ><span>{{ data.balance_amount }}</span>
  <br />
  <br />
  <!-- <span>Exchange rate of ({{ currency }}) Today : </span
  ><span>{{ "100" }} INR</span> -->

  <!-- <form [formGroup]="paymentForm" class="payment">
    <div>
      <mat-form-field
        class="custom-input block-ele mandatory"
        floatLabel="never"
      >
        <label class="custom-label mandatory">Amount Received</label>
        <input
          matInput
          type="number"
          placeholder="Amount Received"
          formControlName="amount_received"
          maxlength="10"
          oninput="javascript:  if (!/^(-?\d+(\.\d{0,3})?)?$/.test(this.value)) this.value = this.value.slice(0, -1);"
        />
      </mat-form-field>
      <mat-error *ngIf="paymentForm.controls.amount_received.hasError('max')">
        Amount cannot exceed Balance Amount.
      </mat-error>

      <mat-error
        *ngIf="
          paymentForm.controls.amount_received.hasError('amountInvalid') &&
          paymentForm.get('amount_received')?.dirty
        "
      >
        Amount should be greater than zero.
      </mat-error>
    </div>

    <mat-form-field class="custom-input block-ele mandatory" floatLabel="never">
      <label class="custom-label mandatory">Date of Payment</label>
      <input
        matInput
        class="datepicker"
        (focus)="openCalendar(picker)"
        (click)="openCalendar(picker)"
        [matDatepicker]="picker"
        placeholder="Choose a date"
        formControlName="date_of_payment"
        [max]="maxDate"
      />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>
  </form> -->

  <form class="payment payment-error" style="padding: 0">
    <app-form-builder
      [module]="'commercial_invoice_add_payment'"
      (trigger)="formEmitEvent($event)"
      [Contacts]="data.rowData ? data.rowData.id : ''"
      [related_to_id]="data.shipment_id ? data.shipment_id : ''"
      [isViewMore]="isViewMore"
    ></app-form-builder>
  </form>
</mat-dialog-content>
<div class="view-more" (click)="viewMore()">
  {{ isViewMore ? "Show Less" : "Show More" }}
</div>
<mat-dialog-actions>
  <span fxFlex></span>
  <button class="back-btn-ui" mat-dialog-close>Close</button>
  <!-- *ngIf="!data.invoiceData?.commercial_invoice[0]?.is_totally_paid" -->
  <button
    mat-raised-button
    (click)="addPayment(paymentForm)"
    [disabled]="
      paymentForm?.invalid == undefined ||
      paymentForm?.invalid ||
      button_disabled
    "
  >
    Apply Payment
  </button>
</mat-dialog-actions>
